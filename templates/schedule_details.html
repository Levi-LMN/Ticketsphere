{% extends 'base.html' %}

{% block title %}Schedule Details{% endblock %}



{% block header %}Schedule Details

{% endblock %}

{% block content %}
    <div class="container mt-4">
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">Schedule Details</h2>
            </div>
            <div class="card-body">
                <h3>Travel Schedule Information</h3>
                <ul class="list-group">
                    <li class="list-group-item"><strong>Departure Location:</strong> {{ schedule.departure_location }}</li>
                    <li class="list-group-item"><strong>Destination:</strong> {{ schedule.destination }}</li>
                    <li class="list-group-item"><strong>Departure Time:</strong> {{ schedule.departure_time.strftime('%Y-%m-%d %H:%M') }}</li>
                    <li class="list-group-item"><strong>Sacco:</strong> {{ schedule.vehicle.sacco.name }}</li>
                    <li class="list-group-item"><strong>Driver:</strong> {{ schedule.vehicle.driver.first_name }} {{ schedule.vehicle.driver.last_name }}</li>
                    <li class="list-group-item"><strong>Email:</strong> {{ schedule.vehicle.driver.email }}</li>
                </ul>

                <hr class="my-4"> <!-- Horizontal line to visually separate sections -->

                <h3>Your Information</h3>
                <ul class="list-group">
                    <li class="list-group-item"><strong>Your Full Name:</strong> {{ current_user.first_name }} {{ current_user.last_name }}</li>
                    <li class="list-group-item"><strong>Your Email:</strong> {{ current_user.email }}</li>
                    <!-- Add more user details as needed -->
                </ul>
            </div>
            <div class="card-footer d-flex flex-column flex-md-row justify-content-md-between align-items-center">
    <!-- Social media icons aligned to the left -->
    <div class="mt-3 mb-2 mb-md-0">
         <a href="#" id="whatsapp-link" class="btn btn-icon btn-success">
            <i class="fab fa-whatsapp"></i> WhatsApp
        </a>
        <a href="tel:+254748778517" class="btn btn-icon btn-info">
            <i class="fas fa-phone"></i> Call Us
        </a>
    </div>

    <!-- Buttons aligned to the right -->
    <div>
        <a href="{{ url_for('view_all_schedules') }}" class="btn btn-secondary">Back to Schedules</a>
        <a href="{{ url_for('checkout', schedule_id=schedule.id) }}" class="btn btn-primary">Proceed to Checkout</a>
    </div>
</div>


        </div>
    </div>
<script>
    document.getElementById('whatsapp-link').addEventListener('click', function () {
        // Get information from the page to include in the WhatsApp message
        var departureLocation = "{{ schedule.departure_location }}";
        var destination = "{{ schedule.destination }}";
        var departureTime = "{{ schedule.departure_time.strftime('%Y-%m-%d %H:%M') }}";
        var sacco = "{{ schedule.vehicle.sacco.name }}";
        var driverName = "{{ schedule.vehicle.driver.first_name }} {{ schedule.vehicle.driver.last_name }}";
        var driverEmail = "{{ schedule.vehicle.driver.email }}";

        // Get the current user's name
        var userName = "{{ current_user.first_name }}";

        // Create the enhanced WhatsApp message with the user's name
        var message = `Hello, I am ${userName}! 🌟 I have a question about the schedule for my upcoming journey:\n\n` +
            `📍 Departure Location: ${departureLocation}\n` +
            `🌄 Destination: ${destination}\n` +
            `🕒 Departure Time: ${departureTime}\n` +
            `🚌 Sacco: ${sacco}\n` +
            `👨‍✈️ Driver: ${driverName}\n` +
            `✉️ Driver Email: ${driverEmail}\n\n` +
            "Could you please provide more details or assistance? Thank you! 🚀";

        // Encode the message for the WhatsApp URL
        var encodedMessage = encodeURIComponent(message);

        // Update the href attribute of the WhatsApp link with your phone number and the encoded message
        this.href = "https://wa.me/+254748778517?text=" + encodedMessage;
    });
</script>
{% endblock %}
